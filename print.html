<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js discord">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Makita</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "discord" : "discord";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('discord')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="modules/index.html"><strong aria-hidden="true">1.</strong> Modules</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="modules/permissions.html"><strong aria-hidden="true">1.1.</strong> Permissions</a></li><li class="chapter-item expanded "><a href="modules/previews.html"><strong aria-hidden="true">1.2.</strong> Previews</a></li></ol></li><li class="chapter-item expanded "><a href="self_hosting/index.html"><strong aria-hidden="true">2.</strong> Self Hosting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="self_hosting/bot_token.html"><strong aria-hidden="true">2.1.</strong> Getting a bot token</a></li><li class="chapter-item expanded "><a href="self_hosting/database_setup.html"><strong aria-hidden="true">2.2.</strong> Setting up the database</a></li><li class="chapter-item expanded "><a href="self_hosting/the_binary.html"><strong aria-hidden="true">2.3.</strong> Getting the binary</a></li><li class="chapter-item expanded "><a href="self_hosting/managing.html"><strong aria-hidden="true">2.4.</strong> Managing your instance</a></li><li class="chapter-item expanded "><a href="self_hosting/configuration.html"><strong aria-hidden="true">2.5.</strong> Configuring</a></li><li class="chapter-item expanded "><a href="self_hosting/running.html"><strong aria-hidden="true">2.6.</strong> Running</a></li></ol></li><li class="chapter-item expanded "><a href="development/index.html"><strong aria-hidden="true">3.</strong> Development</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Makita</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="modules"><a class="header" href="#modules">Modules</a></h1>
<p>Note that the documentation will not include much information about individual commands.
This is because Discord slash commands are self-documenting. Just press the <code>/</code> key on your
keyboard (I hope I don't need to make a chapter on how to do that) and you'll see all the
fancy little commands with descriptions on what they do.</p>
<h3 id="a-hrefmodulespermissionshtmlpermissionsa"><a class="header" href="#a-hrefmodulespermissionshtmlpermissionsa"><a href="modules/./permissions.html">Permissions</a></a></h3>
<p>Manage your permissions</p>
<h3 id="a-hrefmodulespreviewshtmlpreviewsa"><a class="header" href="#a-hrefmodulespreviewshtmlpreviewsa"><a href="modules/./previews.html">Previews</a></a></h3>
<p>Preview message links in chat</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="permissions"><a class="header" href="#permissions">Permissions</a></h1>
<p>The bot has a few permissions that determine who can access certain commands and do certain
things. Each permission entry has a set of Discord permissions that can use it (for example,
by default, people with the <code>Manage Server</code> Discord permission has the <code>Manage Previews</code>
Makita permission) and a set of roles and users who have it. All of this can be configured
with the <code>/permissions</code> command. Note that, because of limitations in Discord, you'll need
to <a href="https://discordapi.com/permissions.html">calculate the permissions bits yourself</a>.</p>
<table><thead><tr><th>Name</th><th>Description</th><th>Default</th></tr></thead><tbody>
<tr><td>Administrator</td><td>Access to all permissions</td><td>Administrator</td></tr>
<tr><td>Manage Permissions</td><td>Manage bot permissions</td><td>Administrator</td></tr>
<tr><td>Manage Previews</td><td>Manage preview configuration</td><td>Manage Server</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="previews"><a class="header" href="#previews">Previews</a></h1>
<p>Previews allow you to display messages in a static, embed-based representation. You can
either run the <code>/previews view</code> command directly or add each channel you want to
automatically preview message links.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="self-hosting"><a class="header" href="#self-hosting">Self Hosting</a></h1>
<p>This chapter will walk you through the process of setting up a self-hosted
instance of Makita.</p>
<p>You are assumed to be using a Unix-based operating system. If not, good luck.</p>
<p>If you need help, join <a href="https://discord.gg/SWMKshyutT">our discord server</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-a-bot-token"><a class="header" href="#getting-a-bot-token">Getting a bot token</a></h1>
<ol>
<li>Navigate to the <a href="https://discord.com/developers/applications">Discord developers page</a></li>
<li>Click <code>New Application</code></li>
<li>Pick a name and click <code>Create</code></li>
<li>Click the <code>Bot</code> tab in the sidebar</li>
<li>Click <code>Add Bot</code> and then <code>Yes, do it!</code></li>
<li>Look to the token section (under the username) and click the <code>Copy</code> button</li>
</ol>
<p>Take a look at the url. You see that big number? Congrats, you've just found your bot's id.
You'll be using that info in the <a href="self_hosting/./managing.html">managing</a> step.</p>
<p>You now have your token on your clipboard. If you ever lose it, you can get it back
by going back to the <a href="https://discord.com/developers/applications">Discord developers page</a>,
clicking your application, going to the <code>Bot</code> tab, and repeating step 6.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setting-up-the-database"><a class="header" href="#setting-up-the-database">Setting up the database</a></h1>
<ol>
<li><a href="https://www.postgresql.org/download/">Install Postgres</a></li>
<li>Connect to the database with the <code>psql</code> tool
<ol>
<li>You may need to use <code>sudo su postgres -c psql</code> to run the command from the right user</li>
</ol>
</li>
<li>Create a user for the bot
<ol>
<li>The command you're looking for is <code>create user &lt;user_name&gt; with password '&lt;password&gt;'</code></li>
</ol>
</li>
<li>Create a database for the bot
<ol>
<li>The command for this is <code>create database &lt;database_name&gt; with owner &lt;user_name&gt;</code></li>
</ol>
</li>
<li>Construct your database url
<ol>
<li>The format is <code>postgres://&lt;user_name&gt;:&lt;password&gt;@localhost/&lt;database_name&gt;</code></li>
</ol>
</li>
</ol>
<p>You'll be using your database url in a future step to configure the bot</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-the-binary"><a class="header" href="#getting-the-binary">Getting the binary</a></h1>
<p>What you do here is entirely dependent on where you're deploying to.</p>
<h2 id="local-installation"><a class="header" href="#local-installation">Local installation</a></h2>
<ol>
<li>Navigate your ass to <a href="https://github.com/squili/makita/releases/latest">https://github.com/squili/makita/releases/latest</a></li>
<li>Observe the assets section and its curated list of entries</li>
<li>Gaze upon the entry labelled <code>makita</code> and click it</li>
<li>Use your computer to move the file to some directory where it can have some privacy</li>
<li>Make sure it has the correct permissions with <code>chmod +x makita</code></li>
<li>Isn't that crazy, you've just downloaded a binary from github</li>
</ol>
<h2 id="remote-installation"><a class="header" href="#remote-installation">Remote installation</a></h2>
<ol>
<li>Navigate your ass to <a href="https://github.com/squili/makita/releases/latest">https://github.com/squili/makita/releases/latest</a></li>
<li>Right-click on the asset labelled <code>makita</code></li>
<li>Click copy link</li>
<li>Download the file onto your remote machine
<ol>
<li>Use <code>wget &lt;link&gt;</code> or your preferred tool for downloading data from the internet</li>
</ol>
</li>
<li>Make sure it has the correct permissions with <code>chmod +x makita</code></li>
</ol>
<p>Remember that Makita will keep itself up to date,
so you will only need to do this process once.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-your-instance"><a class="header" href="#managing-your-instance">Managing your instance</a></h1>
<p>You will need to create a guild to manage your Makita instance. I trust you know how to make
a guild. Once you've made your management guild, you'll need to invite your bot. This must
be done before the first launch of the bot.</p>
<h3 id="getting-an-invite-link"><a class="header" href="#getting-an-invite-link">Getting an invite link</a></h3>
<p>You can run <code>./makita invite -i &lt;bot id&gt;</code> to generate an invite link for the bot. Once you
have the bot running, you can also use the <code>/info</code> command to get an invite link.</p>
<h3 id="updates"><a class="header" href="#updates">Updates</a></h3>
<p>You can check for updates with the <code>/makita checkupdates</code> command and apply updates with the
<code>/makita update</code> command. It will automatically restart, but you can restart manually with
<code>/makita restart</code>. The bot also handles keyboard interrupts and cleanly shuts down in
response to them, so feel free to be a bit rough with it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>Run <code>./makita init</code> and follow its steps.</p>
<p>You'll find the token from the first step, the database url from the second step, and the
manager guild id from the fourth step. The API address can be ignored, just put in a random
valid address like <code>127.0.0.1:3000</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="running"><a class="header" href="#running">Running</a></h1>
<p>This is a comprehensive guide to starting the Makita bot.</p>
<ol>
<li>Run <code>./makita run</code></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development"><a class="header" href="#development">Development</a></h1>
<p>One day, this chapter will describe how to contribute to Makita development.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="theme.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
